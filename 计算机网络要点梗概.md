计算机网络
参考书籍：《计算机网络（原书第7版） 自顶向下方法 (James F. Kurose Keith W. Ross)》

# 第一章 概述

因特网：世界范围的计算机网络，即它是一个互联了遍及全世界数十亿计算设备的网络

主机(host)/端系统(end system)：和因特网相连的设备
	常见的端系统有：桌面PC、Mac、Linux设备、服务器和移动计算机等

端系统通过通信链路 (communication link)和分组交换机(packet switch)连接到一起

交换机类型：
	路由器：router，常用于网络核心中
	链路层交换机：link-layer switch，常用于接入网中

分布式应用程序：distributed application，应用程序设计多个相互交换数据的端系统

套接字接口：socket interface，与因特网相连的端系统提供的端口，规定运行在一个端系统上的程序请求因特网基础设施向运行在另一个端系统上的特定目的地程序**交付数据的方式**

协议：Protocol，定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和或接收一条报文或其他事件所采取的动作

主机的两大类

- 客户：client，客户通常是桌面 PC 、移动 PC 和智能手机等
- 服务器：server，服务器通 常是更为强大的机器，用于存储和发布 Web 页面、流视频、中继电子邮件等 

接入网：指将端系统物理连接到其边缘路由器（edge router）的网络
		边缘路由器是端系统到任何其他远程端系统的路径上的第一台路由器

数字用户线：Digital Subscriber Line，DSL 标准定义了多个传输速率，包括 12 Mbp 下行和 l. 8 Mbps 上行传输速率 I TU 1999 ] , 以及 55 Mbps 下行和 15 Mbps 上行传输速率 I TU

## 1.1 网络核心

- 分组交换：从**源**端系统向**目的端**系统发送个报文源将长报文划分为较小的数据块，称之为分组（packet）
  		在源和目的地之间，每个分组都通过通信链路和分组交换(packet switch) 传送
- 排队时延和分组丢失
  每台分组交换机有多条链路与之相连对于每条相连的链路，该分组交换机具有**输出缓存** (output buffer, 也称为输出队列 (output queue)) , 用于存储路由器准备发往那条链路的分组
  **排队时延** (queuing delay) ：如果到达的分组需要传输到某条链路，且该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待，因此除了存储转发时延以外，分组还要承受输出缓存的排队时延 (queuing delay) ，程度取决于网络的拥塞程度
  **分组丢失**（丢包） (packet loss)：缓存空间的大小有限， 一个已到达的分组可能发现该缓存已被其他等待传输的分组完全充满，在此情况下，将出现分组丢失（丢包） (packet loss) , 到达的分组或已经排队的分组之一将被丢弃
- 转发表和路由选择协议
  **转发表** ( forwarding table) ：用于将目的地址 （或目的地址的一部分）映射成为输出链路
  路由选择协议：可以决定从每台路由器到每个目的地的最短路径，并使用这些最短路径结果来配置路由器中的转发表

## 1.2 分组交换网络中的时延

分组从台主机（源）出发，通过一系列路由器传输，在另一台主机（目的地）中结束它的历程。当分组从一个节点（主机或路由器）沿着这条路径到后继节点（主机或路由器），该分组在沿途的每个节点经受了几种不同类型的时延

- **节点处理时延** (nodal processing delay) ：检查分组首部和决定将该分组导向何处所需要的时间、检查比特级别的差错
- **排队时延** (queuing delay ）：在队列中，当分组在链路上等待传输时，它经受排队时延，一个特定分组的排队时延长度将取决于先到达的正在排队等待向链路传输的分组数量
- **传输时延** ( transmission delay) ：是将所有分组的比特推向链路（即传输，或者说发射）所需要的时间 
- **传播时延** (propagation delay) ：从该链路的起点到路由器传播所需要的时间
  **节点总时** total nodal delay )：时延总体累加起来是节点总时 total nodal delay ) 

在任何时间瞬间的**瞬时吞吐量**（instantaneous throughput)：是主机接收到该文件的速率（以 bps 计）

## 1.3 协议分层

因特网协议栈和OSI参考模型示意图

![image-20240419160957444](C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240419160957444.png)

### 1.3.1 因特网协议栈

- 应用层：网络应用程序及它们的应用层协议存留的地方；包括例如 HTTP (它提供了 W~b 文档的请求和传送）、 SMTP (它提供了电子邮件报文的传输）和 FTP (它提供两个端系统之间的文件传送）
- 运输层：应用程序端点之间传送应用层报文；包括两种运输协议，即 TCP和UDP
- 网络层：负责将称为数据报 (datagram) 的网络层分组从一台主机移动到另一台主机
- 链路层：网络层将数据下传给链路层，链路层沿着路径将数据报传递给下一个节点，在该下一个节点，链路层将数据报上传给网络层
  			包括以太网 WiFi 和电缆接入网的 DOCSIS 协议 
- 物理层：将链路层的帧中一个个比特从一个节点移动到下一个节点

OSI 参考模型的7层是：应用层、表示层、会话层、运输层、网络层、数据链路层和物理层

# 第二章 应用层

## 2.1 应用层协议原理

研发网络应用程序的**核心是写出能够运行在不同的端系统和通过网络彼此通信的程序**。

重点关注如何用程序实现端系统间通信，而程序的书写首先必须是基于框架的，互联网**应用的体系结构**分为两种：CS架构和P2P架构。

- CS服务体系：client-server architecture，CS服务体系指的是服务器和客户端组成的架构
  		服务器 ：服务器是**一直运行着**的，通过**固定IP与端口号**来访问的，**可扩展性较差**的终端设备
    		客户端：客户端在网络中以**动态IP**的方式标识，并**主动与服务器建立通信**
- P2P服务体系：P2P architecture
  	在P2P体系结构中，任何端系统既可以是客户端，也可以是服务器，可扩展性强**，**任意两台端设备之间可以通信

### 2.1.1 分布式进程通信

**通信的实体是进程**
发送进程生成并向网络中发送报文；接收进程接收这些报文并可能通过报文进行响应

通常使用**32位的IP地址来唯一的标识一台主机**，在主机之上，用**端口号来标识特定的进程**
		比如HTTP,**TCP的默认端口号就为80**，进程可以使用TCP或者UDP的传输层协议进行通信

**套接字Socket **

软件接口，应用程序可通过该接口向网络中发送报文和接收报文

socket是用于指明应用进程会话的**本地标识**

> 进程可类比于一座房子，而它的套接字可以类比于它的门。当一个进程想向位于另外一台主机上的另一个进程发送报文时，它把报文推出该门（套接字）。该发送进程假定该门到另外一侧之间有运输的基础设施，该设施将把报文传送到目的进程的门口。一旦该报文抵达目的主机，它通过接收进程的门（套接字）传递，然后接收进程对该报文进行处理。

实际上，socket是操作系统生成的一个整数，这个整数可以理解为**传输信息的引用**。这些信息具体的说，即是包含源IP，源port，目标IP，目标port的四元组
	*四元组是针对TCP的socket信息*

UDP Socket
使用UDP提供的服务时，两个进程之间的通信不需要建立连接，即**不面向连接**，每个报文都是独立传输的，它的前后报文也可能被送到**不同的分布式进程**，即对于UDP的socket，**只需**指明报文将发往何处，而不必关心报文来自哪里

### 2.1.2 应用层协议

**应用层的协议**，使用**API**来调用网络基础设施来提供通信服务传报文，解析报文，实现应用时序等
		应用层的协议定义了运行在不同端系统上的应用进程如何相互交换报文
		包含报文的类型，报文类型对应的语法，报文中字段的语义，报文所导致的动作

## 2.2 Web和http

Web的应用层协议为超文本传输协议（HTTP）
HTTP定义了Web客户向Web服务器请求Web页面的方式，以及服务器向客户传送Web页面的方式

**对象**：对象可以认为是**HTML页面的最小组成单元**
Web页面：由对象组成，浏览页面时，不同的对象并非同时出现，对象可能来自不同的目的地

**URL**(统一资源定位符)：标识由对象组成的HTML页面，URL表示资源的**地点**（资源的来源IP）

**HTTP的请求-响应行为**(HTTP使用TCP作为支撑运输协议，浏览器和服务器进程通过套接字接口进行访问TCP)

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240419173455190.png" alt="image-20240419173455190" style="zoom:67%;" />

页面呈现给用户的流程：

1. 浏览器通过HTML表单或超链接请求指向一个**应用程序的URL**
2. 服务器收发到用户的请求
3. 服务器执行已接受创建的指定应用程序
4. 应用程序通常是基于用户输入的内容，执行所需要的操作
5. 应用程序把结果格式化为网络服务器和浏览器能够理解的文档，即HTML网页
6. 网络服务器最后将结果返回到浏览器中
7. 浏览器使用解释器解析页面

非持续连接：non-persistent connection，每个请求/响应对时英国一个单独的TCP连接发送的
持续连接：persistent connection，所有请求及响应经相同的TCP连接发送
	持续连接在客户和服务器中都需要分配**TCP的缓冲区和保持TCP变量**

### 2.2.1 HTTP报文

HTTP报文都是以**ASCII码**的形式与人交互
	**请求报文**格式示意图：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240419174640485.png" alt="image-20240419174640485" style="zoom:67%;" />

- 请求行：包含三个字段段：方法字段、 URL 字段和 HTTP 版本字段
  		方法字段：请求对象的方法，可取不同的值，包括 GET、POST、HEAD、PUT、DELETE
    		URL字段：带有请求对象的标识；版本字段：是自解释的
- 首部行：指明了对象所在的主机
- “实体体" (entity body）：使用 GET 法时实体体为 空，使用 POST 方法时才使用该实体体

​	**响应报文**格式示意图：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240419174850009.png" alt="image-20240419174850009" style="zoom:67%;" />

### 2.1.3 cookie

用于绑定用户与服务器访问

cookie技术的4个组件：

- HTTP 响应报文中的一个cookie 首部行
- 在 HTTP 请求报文中的一个cookie 首部行
- 在用户端系统中保留有一个cookie文件，并由用户的浏览器进行管理
- 位于 Web 站点的一个后端数据库

cookie 可以用于**标识**一个用户 用户首次访问一个站点时，可能需要提供一个用户标识（可能是名字） 在后继会话中，浏览器向服务器传递一个 cookie 首部，从而向该服务器标识了用户，因此 cookie 可以在无状态的 HTTP 之上建立一个用户会话层

### 2.1.4 Web缓存

Web cache，也叫代理服务器，proxy server，能够代表初始Web服务器来满足HTTP请求的网络实体

目的：解决客户请求服务器资源时因为链路太长导致响应时间慢

做法：**在局域网内部增加缓存节点**。也就是Web代理，购置一台服务器就好了，还可以通过增加缓存的命中率来**减轻服务器的负载，降低网络的通信量**

Web 缓存器既是服务器又是客户，当它接收浏览器的请求并发回响应时，它是服务器；
当它向初始服务器发出请求并接收响应时，它是客户

**HTTPS**

下图URL的前面有一个**锁的标识**，这里的锁实际上标识使用的协议是HTTPS

![image-20210408101342730](https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img3/202310262113511.png)

对**通信链路**进行加密：**SSL安全套接字层/TLS安全层传输协议**

SSL采用一种叫做公开密钥加密的加密处理方式，这里可以尝试客户端使用公开密钥加密，而服务器端使用私有秘钥解密的策略

HTTPS使用混合加密机制，在**交换密钥环节使用公开密钥加密方式**，之后的**建立通信交换报文使用共享密钥加密方式**

- 身份验证：HTTP协议中的请求与响应，任何人都可以发起请求，如果发起多次**恶意请求，网站负载就会增大**，显然需要机制来确认通信方的身份，SSL不仅提供加密处理，还使用了称之为**证书**的手段来身份认证，证书由靠谱的第三方机构颁发。

- 报文完整性：在通信过程中，防止内容篡改，使用一种指代内容的唯一标识，**MD5和SHA**就是常用的方法，

> HTTPS = HTTP + 加密 + 认证 +完整性保护

## 2.3 FTP&Email

**FTP**

- FTP的服务器始终守护在21号端口处等待连接，FTP的客户端发起连接请求，**基于TCP的控制连接**建立
- **用户身份认证**，认证后访问文件目录，也因此需要维护历史信息，即**FTP是有状态的协议**，值得一提的是，身份认证是使用**明文传输**
- 服务器**主动**与客户端的20号端口建立**数据连接**，客户端下载数据

**Email**

三部分构成：**用户代理**（user agent，也就是客户端软件）、**邮件服务器**，**协议**

1. 首先用户在用户代理中写好邮件，用户代理通过**STMP协议**将邮件传输到**用户邮箱服务器的队列**中
2. 邮箱服务器再将邮件从队列中提取出来，使用SMTP协议将邮件发送到目标服务器
3. 目标服务器将邮件存储在**目标用户的邮箱目录**中
4. 目标用户通过**POP3协议**从邮箱中拉取邮件阅读
       POP3 按照三个阶段进行工作：特许 (authorization) 、事务处理和更新

- 第一阶段：特许阶段，用户代理发送（以明文形式）用户名和口令以鉴别用户
- 第二个阶段：事务处理阶段，用户代理取回报文；同时在这个阶段用户代理还能进行如下操作，对报文做删除标记，取消报文删除标记，以及获取邮件的统计信息
- 第三个阶段：更新阶段，在客户发出了quit命令后，目的是结束该 POP3 会话；；这时，该邮件服务器删除那些被标记为删除的报文

关于Email编码

Email使用**7位的ASCII码**编码，中文需要两个字节描述，如果使用7位ASCII码传输时就会乱码
为了防止乱码，使用**MIME多媒体扩展协议**，这是基于**Base64**的编码，即**将ASCII码序列化**再传输

## 2.4 DNS

### 2.4.1 概述

Domain Name System，域名系统
功能：进行主机名到IP地址**转换**的目录服务

DNS是用来**为其他应用协议提供服务**的协议，DNS的功能是**完成域名到IP地址的转换**，转化实质上是由**DNS系统**来完成

如果我们想访问一个网站，那就需要在地址输入栏中输入网站的URI，而URI中需要**包含易记的用来标识端系统位置**的东西，这就是**域名**，域名是一个端系统的**别名**，易于记忆

DNS提供的服务

- 主机别名，host aliasing，有着复杂主机名的主机能够拥有一个或者多个别名
- 邮件服务器别名：mail server aliasing，电子邮件应用程序可以调用DNS，对提供的主机别名进行解析或者规范主机名和IP地址
- 负载分配：load distribution，DNS在冗余的Web服务器之间循环分配负载

### 2.4.2 DNS架构

采用分布式的设计方案：**分布式的数据库**。

部分DNS服务器的层次结构示意图：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420144835007.png" alt="image-20240420144835007" style="zoom:67%;" />

- 根DNS 服务器：有400 多个根名字服务器遍及全世界，根名字服务器的全部清单连同管理它们的组织及其 IP 地址可 以在 Root Servers 2016 中找到，根名字服务器提供 TLD 服务器的 IP 地址 
- 顶级域 (DNS) 服务器：对于每个顶级域（如 com org net edu gov) 和所国家的顶级域（如 uk fr ca jp)，都有 TLD 服务器 （或服务器集群），TLD 服务器提供了权威 DNS 服务器的 IP 地址 
- 权威 DNS 服务器：在因特网上具有公共可访问主机（如 Web 服务器和邮件服务器）的每个组织机构必须提供公共可访问的 DNS 记录，这些记录将这些主机的名字映射为IP地址

**DNS缓存**

- 目的：改善时延性能并减少在因特网上传输的DNS报文数量
- 原理：在一个请求链中，当某DNS服务器接收DNS回答（例如，包含某主机名到IP地址的映射）时，它能将映射缓存在本地存储器中

### 2.4.3 报文结构

**资源记录**：Resource Record，RR，提供主机名到IP地址的映射，每个 DNS 回答报文包含了一条或多条资源记录

资源记录包含4元组字段：
	`Name`：主机名 
	`Value`：主机名对应的IP地址
	`Type`：决定Name和Type的值，类型有：`A NS CNAME MX`
	`TTL`：TTL 是该记录的生存时间，它决定了资源记录应当从缓存中删除的时间

DNS报文格式如下图所示：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420154955972.png" alt="image-20240420154955972" style="zoom:67%;" />

## 2.5 P2P

P2P的产生是为了解决CS体系的缺陷，即**服务器压力大，负载均衡能力弱，可靠性不好**
		P2P体系常常被应用在**文件分发，流媒体**，在这些应用场景中，peer节点的压力比较轻

P2P的管理模式

- 非结构化的P2P：邻居节点间存在互通有无的关系，形成**覆盖网**。典型的应用是**文件共享**，即通过**集中目录**的方式，用户首先键入**关键字**，然后**目录服务器**告诉用户有哪些节点拥有该资源，用户建立**TCP连接**，再去请求某节点的资源。拥有该资源后，将自己拥有该资源的信息**上报目录服务器**，流程结束。

  但集中式的目录，存在**单点故障，性能瓶颈，侵犯版权**的问题。查询时采用**洪泛**的方式有可能导致**请求无限放大**

- 结构化的P2P：节点与节点之间的关系是往往成**网状或者环状**的。在更新节点时始终维护节点间的关系，即根据哈希值更新环。

## 2.6 CDN

Content Distribution Network，内容分发网
	所有主要视频流公司都利用CDN

视频是**固定速度显示的图片序列**，而图片是由许多**像素点集成**得到的，因此视频数据大，编码复杂
	网络视频的特点：高码率、可压缩

降低视频流量的方式：**降低码率并做时空上的压缩**（比如AVS编码方式）
**缓存原理**：互联网提供给我们的是存储视频的流化服务，它可以实现辺下载辺看，就像河流一般，我们在从缓冲区中取视频内容，实现了高并发的视频传输

**动态自适应的流化技术DASH**：服务器端并不会有选择性的发送内容，它将视频分块，每块有不同的解析度，不同的编码标准，为了为客户端标识不同块的URL，服务器还维护一个**告示文件**用以提供不同块的URL
	客户端首先获取到告示文件，然后**周期性的测试**服务器到客户端的**带宽**，根据带宽来**实时**地请求某一块，最后**解析**观看视频。

CDN服务商使用的部署策略来加速通常有两种

- `策略1`：在本地ISP的区域内部署缓存节点，这样离用户最近，但未免投入太高。
- `策略2`：靠近ISP的数据中心部署，效果也很不错，而且部署的节点相对较少，减少了成本。

CDN服务使用步骤：ICP预先部署资源到CDN节点 -> 用户访问Netflix的注册网站 -> 重定向到部署在亚马逊云端的网站 -> 使用域名解析重定向的机制从最近的CDN节点中获取资源 -> 将动态自适应的资源返回给用户

## 2.7 套接字编程简介

UDP套接字

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420160643511.png" alt="image-20240420160643511" style="zoom:67%;" />

TCP套接字

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420160709384.png" alt="image-20240420160709384" style="zoom:67%;" />

# 第三章 运输层

## 3.1 概述和运输层服务

传输层位于应用层与网络层之间，起着承上启下的重要作用
**传输层协议为运行在不同主机上的进程提供逻辑通信的功能**。而从TCP/IP协议族的组成来看，向上使**进程间的通信成为可能**，向下**加强了网络层提供的尽力而为式**的服务

运输层提供TCP和UDP两个协议服务

TCP： TCP提供服务是可靠的，保序的，有拥塞控制，流量管理机制的，面向连接的，涉及复用与解复用，数据以**字节流**的形式传输

UDP:   UDP提供的服务是不可靠的，不保序的，不面向连接的，数据以**数据报**的形式传输

运输层类比关系：Ann、Bill分别代表两个家庭，类比背景为两个家庭进行信封邮局通信

![image-20240420164131599](C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420164131599.png)

## 3.2 多路复用与解复用

我们在PC上可以同时运行QQ,网易云.它们是从属于不同的进程，所以当传输层向上层传输信息时，需要标识给哪一个进程，也就是需要使用**Socket来标识一个进程**，那向上传输的内容，除了Socket，显然还需要有报文。**报文中包含传输层的首部字段和MSG**。这里的描述其实就是解复用的过程

- 复用：在源主机从不同的套接字中收集数据块，并**为每个数据块封装首部信息**，生成报文段，最终将报文段交付于网络层
- 解复用：将传输层报文段中的数据交付给应用进程的过程
- 多路分解(demultiplexing)：将运输层报文段中的数据交付到正确的套接字的工作
- 多路复用(multiplexing) ：在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息，从而生成报文段，然后将报文段传递到网络层

传输层的多路复用与解复用实现的就是`将主机到主机的交付服务延伸到应用程序到应用程序之间`，关注将报文传给谁，报文中包括什么

<img src="https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img2/202310262101368.png" alt="image-20210707210324385" style="zoom: 50%;" />

### 3.2.1 无连接的多路复用与解复用

示意图

<img src="https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img2/202310262101248.png" alt="image-20210707210337051" style="zoom: 50%;" />

- 主机A中的传输层创建一个传输层报文，**报文包含应用程序数据，源端口号19157，目的端口号46428和其他两个值**。接着，传输层将该报文段传输给**网络层**，网络层再将报文段封装到一个**IP数据报**中，并通过网络链路交付给接收主机

- 接收主机传输层检查该报文段中的**目的端口号46428**，并将该报文段交付给端口号46428所**标识的套接字**

**socket是不被包含在报文段中的**。UDP的Socket包含目的IP，目的端口号，它仅用于处理源端口或者目标端口的**识别**，即**层间接口**
但报文是实际参与通信过程的。这里的socket就像是一个**开门的钥匙**。

### 3.2.2 面向连接的多路复用与解复用

示意图：

<img src="https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img2/202310262101328.png" alt="image-20210707224235450" style="zoom:50%;" />

图中主机C向服务器B发起了两个 HTTP 会话，主机A向服务器B发起一个HTTP会话。主机A与主机C及服务器B都有自己唯一的IP地址，分别是A、C、B
主机C为其他两个HTTP连接分配两个不同的源端口号 (26145和7532)。因为主机A选择源端口号时与主机C互不相干，因此它也可以将源端口号 26145 分配给其HTTP连接，即服务器B仍然能够正确地分解这两个具有相同源端口号的连接，因为这两条连接有不同的源 IP 地址

UDP：用户数据报协议，它仅在网络层的基础上提供**必要的复用，解复用，以及简单的校验和**。这使得它的功能基本上和网络层一致

UDP的报文结构：

<img src="https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img2/202310262102234.png" alt="image-20210707224316644" style="zoom:33%;" />



## 3.4 可靠数据传输原理

可靠数据传输是一个**一般性的问题**，它不仅在传输层使用这个机制，在网络层和应用层也可以实现

可靠数据传输框架示意图：
为上层实体提供的服务抽象是：数据可以通过一条可靠的信道进行传输，借助可靠信道，传输数据比特就不会收到损坏或者丢失，且所有数据都按照发送顺序进行交付

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420181214505.png" alt="image-20240420181214505" style="zoom:67%;" />



### 3.4.1 rdt1.0

原语具体描述

- `rdt_send:`被上层调用，将数据交付给下层的发送方实体
- `udt_send:`被rdt调用，将分组通过不可靠的信道发送给接收方
- `rdt_rcv:`分组到达接收方时被调用
- `deliver_data:`被rdt调用，将数据交付给上层

rdt1.0发送方和接收方的有限状态机（Finite-State Machine，FSM）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420181732245.png" alt="image-20240420181732245" style="zoom:50%;" />



### 3.4.2 rdt2.0

**标记量**：接受方检测到比特出错，发送显示的发送错误标志，`NAK`，当检测后发送无误，就发送显示的发送正确标志，`ACK`
	肯定确认：Positive acknowledgment；否定确认：Negative acknowledgment

- 发送方：当rdt接收到应用层的数据后，将数据与校验和组成传输报文通过不可靠的信道发送给接收方，然后发送方等待接收方的回应。当等待到的是ACK时，继续等待上层调用。
- 接收方：接收方接收来自不可靠信道的数据，然后做校验，当校验出错时发送NAK,校验正确时发送ACK

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420182407033.png" alt="image-20240420182407033" style="zoom: 50%;" />

缺陷：无法考虑ACK或NAK分组受损的可能性

### 3.4.3 rdt2.1、rdt2.2

rdt2.1的发送方和接收方FSM的状态数都是以前的两倍。这是因为协议状态此时必须反映出目前（由发送方）正发送的分组或（在接收方）希望接收的分组的序号是0还是1；

协议rdt2.1使用了从接收方到发送方的**肯定确认和否定确认**，当接收到失序的分组时，接收方对所接收的分组发送一个肯定确认；如果收到受损的分组，则接收方将发送一个否定确认

### 3.4.4 rdt3.0

rdt3.0的发送方FSM示意图：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420213445485.png" alt="image-20240420213445485" style="zoom:67%;" />

即当分组发送出去后，计时器开始倒计时，如果计数到0还没有收到响应，那就重传
	-- 每次发送一个分组，包括第一次分组和重传分组时，启动一个定时器
	-- 响应定时器中断
	-- 终止定时器

**流水线协议**

我们将这种发送多个分组可以看做是填充到一条流水线中，流水线协议在rdt3.0基础上增加了**传输分组的粒度**

- 分组的序号显然只用0和1是不够的，必须**扩大分组序号的范围**，来唯一地标识一个分组；
- 分组传输与接收的速率不一致，需要在接收方增加**缓存机制**，此外，发送方在发送分组以后可能处于两种状态：等待确认,确认完成，所以发送方的分组需要分区，即发送方也需要缓存机制；
- 当分组出现损坏，丢失，延迟时，根据场景有两种可选的方式：`GBN(Go-Back-N，回退N步)和SR(Selective Repeat选择重传)`.

这两种处理差错的方式又都是基于**通用的滑动窗口**实现
	滑动窗口是在**缓冲区的基础上**运作

- 发送缓冲区：缓冲区即是内存中的一块区域，它有大小属性，这里的发送缓冲区大小可以为1，即RDT3.0,当大小>1时，即为流水线协议。这里的发送缓冲区用于**存放已发送未确认的分组**，以便用于检错重发或超时重传
- 接收缓冲区：是为了解决分组在信道中传输的速率与接收方接收的**速率不一致**的问题所引入的。它的大小为1时即为RDT3.0,当发送缓冲区大小>1时，接收缓冲区可以为1，此时为GBN协议，如果接收缓冲区>1,则为SR协议

利用滑动窗口表示缓冲区动态传输过程

**GBN**

GBN 协议中，允许发送方发送多个分组（当有多个分组可用时）而不需等待确认，但它也受限于在流水线中未确认的分组数不能超过某个最大允许数N（N常被称为**窗口长度**）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420215705765.png" alt="image-20240420215705765" style="zoom:50%;" />

GBN发送方必须响应三类事件

- 上层的调用
- 收到一个ACK
- 超时事件

**SR**

SR发送方看到的序号空间示意图：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240420220044300.png" alt="image-20240420220044300" style="zoom:50%;" />

- 接收窗口的尺寸大于1，可以乱序接收：
- 接收窗口中有不同分组，收到分组后，接收窗口向前滑动。但如果分组没有按序到来
- 当高序号的分组到来后，仍旧将其缓存，但并不移动滑动窗口，只有当低序号的分组到来后，窗口才会整体后移


**用FSM描述的GBN**

1. 发送方

   首先声明这些变量代表的含义：`N为窗口长度，base为窗口后沿，nextseqnum为满足发送条件但因缓冲区已满没有发送的分组序号`，

![image-20210707224840765](https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img3/202310262107249.png)

2. 接收方

   ![image-20210707224850680](https://cdn.jsdelivr.net/gh/YuZhe727/xiaozhe_img/img3/202310262107610.png)

## 3.5 面向连接的传输TCP

TCP提供的是点到点，可靠的，管道化的，按序的字节流，拥有流量控制机制，面向连接的服务

点对点：一个发送方，一个接收方
可靠、按顺序的字节流：没有报文边界
管道化（流水线）：TCP拥塞控制和流量控制设置窗口大小
发送和接收缓存
全双工数据：再同一连接中数据流双向流动，MSS：最大报文段大小
面向连接：在数据交换之前，通过握手（交换控制报文）初始化发送方、接收方的状态变量
有流量控制：发送方不会淹没接收方

### 3.5.1 段结构

TCP的报文段由一个**首部字段和数据字段**构成，数据字段即是应用层的数据

这里引入**最大报文段长度MSS**的概念。TCP会将要传输的文件分为若干个MSS。**MSS的长度**通常由**本地发送主机发送的最大链路层帧长度**来设置。在确定数据部分后，TCP为每个客户端数据配上一个**TCP首部**，从而形成多个TCP报文段。

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240421004216068.png" alt="image-20240421004216068" style="zoom:67%;" />

具体字段介绍：

- 源端口号：TCP提供的是进程之间的逻辑通信，而标识进程的即是端口号，标识源端口号就相当于给出了数据**复用**的路径。

- 目的端口号：同样的，只有给出目的端口号，在接收方才能完成**解复用**的工作。

- 序号：TCP把数据看做一个**无结构，有序的字节流**。而为了来标识每个报文段(`MSS`)的首字节在整个字节流中的位置，或者说偏移量，就引入了序号的概念。该序号的范围为**2的32次方**，可见冲突的几率比我中彩票还低~

- 确认号：在可靠数据传输中，我们使用ACK来作为确认字段，但ACK只能表示接收方对接收到数据的回应，而实际的传输是全双工，且高并发的。所以接收方的确认号将**确认与下一次传输的数据相结合**作为确认号。也就是说，假设确认号为2000,即表示**期望收到的下一个字节的序号**，这里给出的序号同样也具有**GBN累计确认**的意义。

  传输过程示意图：

  <img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423170631037.png" alt="image-20240423170631037" style="zoom:50%;" />

  即主机A发送序号42及对于序号79的确认，主机B收到后，发送对于序号42的确认，即ACK=43，且发送主机A期望的79，即seq=79

- 接收窗口：该字段用于**流量控制**，即指示接收方愿意接受的字节数量，在抓包的时候任一数据发送源都会使用**Win字段**来告诉另一方自己接收窗口的大小

- CRC校验和：在UDP部分谈及过，用于**检错**

即当超时定时器触发以后，发送方会传输**至今没有得到确认的最小序号分组**。即这里的机制又是类似于**选择性重发SR**。在重发后，超时定时器又会与当前没有得到确认的最小序号分组相关联。此外，还有一种情况，即缓冲区为空，即所有的分组都已得到确认，此时需要重启定时器

**穷举关于ACK情况及相应的处理方式**

| **接收方事件**                                         | **TCP接收方动作**                            |
| ------------------------------------------------------ | -------------------------------------------- |
| 所期望序号的报文段按序到达，期望序号之前的都已得到确认 | 延迟的ACK，即对另一个按序报文段最多等待500ms |
| 有期望序号的报文段到达，另一个按需报文段等待发送ACK    | 立即发送单个累积ACK，以确认两个按序报文段    |
| 比期望序号大的报文段乱序到达，检测到数据流的间隔       | 立即发送重复ACK，指明下一个期待字节的序号    |
| 能部分或者完全填充接收数据间隔的报文段到达             | 若该报文段起始于间隔的低端，则立即发送ACK    |

### 3.5.2 流量管理

传输层在将数据解复用以后，放置在**接收缓冲区**内，上层应用再**从缓冲区中读取数据**
当发送方发送来的数据太多就有可能**淹没接收缓冲区**，导致报文段丢失，因此，约定发送方的发送速率与接收方的接收速率是必须的，这种**为了匹配速率的机制就称为流量控制**

流量控制机制是通过互相告知缓冲区可用空间来实现的
实现手段：通过接收方向发送方发送的报文段中的**rwnd字段**，它表示了**接收缓冲区中可用的空间**

rwnd具象化---接收窗口
量化接收窗口的大小，引入两个变量：
		`LastByteRead`:主机B上的应用进程从缓存读出的数据流的最后一个字节的编号
		`LastByteRcvd`:从网络中到达的并且已放入主机B接收缓存中的数据流的最后一个字节的编号

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423171715478.png" alt="image-20240423171715478" style="zoom: 67%;" />

变量rwnd的图示：
<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423171801848.png" alt="image-20240423171801848" style="zoom:50%;" />

### 3.5.3 三次握手

三次握手设计思想：**在双方半连接的基础上增加两个半连接的交互**
三次握手的详细过程：

1. 第一次握手：客户端的TCP首先向服务器端的TCP发送一个特殊的TCP报文段（不包含应用层数据），报文段首部中的**SYN**比特位**被置为1**（该特殊报文段被称为**SYN报文段**）。另外，客户会**随机地选择一个初始序号**（client_isn）,并将此编号放置于该起始的TCPSYN报文段的序号字段中

2. 第二次握手：服务器从该数据报中提取出SYN报文段，为该TCP连接**分配TCP缓存和变量**，并向该客户TCP发送允许连接的报文段。这个允许连接的报文段**不包含应用层数据**。但在报文段首部包含**3个重要的信息**

   - SYN比特被置为1
   - TCP报文段首部的确认号字段被置为**client_isn+I**
   - 服务器选择自己的初始序号（**serverjsn**）,并将其放置到TCP报文段首部的序号字段中。这个允许连接的报文段实际上表明了：**“我收到了你发起建立连接的SYN分组，该分组带有初始序号clientjsno我同意建立该连接。我自己的初始序号是serverjsnon**

   该允许连接的报文段被称为**SYNACK报文段**

3. 第三次握手:在收到ACK报文段后，客户要给该连接**分配缓存和变**量。客户主机则向服务器发送另外一个报文段；最后一个报文段**对服务器的允许连接的报文段进行了确认**（该客户通过**将值serverjsn+1放置到TCP报文段首部的确认字段**中来完成此项工作）。因为连接已经建立了，所以该**SYN比特被置为0**。该三次握手的第三个阶段可以在报文段**负载中携带客户到服务器的数据**

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423172340209.png" alt="image-20240423172340209" style="zoom:50%;" />

### 3.5.4 四次挥手

1. 客户端进程向服务器进程发送一个特殊的报文段，该报文段中首部标志位**FIN置1**
2. 服务器接收该报文段后，**其ACK比特置1**
3. 反向同理

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423172758100.png" alt="image-20240423172758100" style="zoom:50%;" />

## 3.6 拥塞控制原理

在rdt可靠数据传输机制中，分组丢失是不可避免的，而**分组丢失的原因通常是由网络拥塞**
当路由器的缓存被占满后，后来者将会别抛弃

网络拥塞：太多的数据需要网络传输，超过了网络的处理能力。

理想不拥塞状态

- 路由器缓存无限大
- 端系统可以了解网络的状况并作出调整

- 所有分组都可以不超时的到达，所以不需要重传

### 3.6.1 拥塞控制的方式

- 端对端的拥塞控制：端系统根据延迟和丢失事件推断是否有拥塞（TCP使用的策略）
- 网络辅助的拥塞控制：路由器通过**置位**的方式显示的告诉发送端可以采用的速率

## 3.7 TCP拥塞

**TCP的拥塞控制机制**。而在开始之前，我们先解决一个前置问题：TCP`为什么不在网络核心通过使用辅助信元的方式实现拥塞控制`。其实，纵观整个网络架构，复杂性都是在传输层及其以上提供的，也就是说，`网络层不会向上层应用提供显式的拥塞控制机制`。

TCP拥塞机制面临的**问题**

- `如何感知到拥塞`

  网络拥塞的最终结果是分组丢失，而导致分组丢失的原因却有一些区别——

  1. 假如到达路由器的分组过多导致缓冲区已满，**分组就会被丢弃**。此外，有可能分组在传输时比特反转，接收方认不出来这是啥，那也会将其丢弃。这两种情况的直观表现都是超时，这种`拥塞情节严重`，发送方明显被动。
  2. 当发送方连续收到4个ACK信号，也就是**3个冗余ACK**时，就会触发快速重传机制，这时还没有超时，发送方主动出手降低损失，姑且称其`轻微拥塞`。

- `如何对速率做调整`

  那明确了问题，如何针对两种拥塞做出发送速率的调整呢？在**RDT**中，我们引入`接收窗口rwnd`来限制接收分组，这里我们也采用类似的机制，引入`拥塞窗口cwnd`。类比接收窗口表示能够接收分组的上限，拥塞窗口表示的即是——

  

  是不是似曾相识，发送窗口表示的是**实际的**已发送未确认的分组数量。而拥塞窗口就如同在对发送窗口做**动态调整**，除此之外，别无二致。那确定了拥塞窗口的值，发送方的发送速率也可以得出来——

  

- `通过怎样的算法对速率做调整：`

### 3.7.1 **TCP拥塞控制算法**

该算法分为三部分：慢启动，拥塞避免，快速恢复

- **慢启动**

  TCP会将cwnd的值初始化为一个2/3/4MSS(具体由MSS的大小决定)的值，，当分组首次被确认后，则以指数级的增长趋势尽快加速，直至超时后重回1个MSS。这时，TCP会维护一个**慢启动阈值**，即警戒值，它的值为**cwnd(max)/2**，随后开始下一次拥塞控制，当cwnd的值指数增加至慢启动阈值后，不再指数级增长，而**维持线性增长**

  <img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423180400305.png" alt="image-20240423180400305" style="zoom:67%;" />

  这种线性增长的机制就是拥塞避免

- 拥塞避免

  拥塞避免阶段在触发超时后会重新开始SS慢启动阶段,这时，慢启动的阈值会更新

  发送方收到**3个冗余ACK**的状况：处理机制只需要在触发快速重传后，记录慢启动阈值，然后直接从阈值开始线性增加进入快速恢复阶段

- 快速恢复

  快速恢复是针对两种拥塞状况的不同种处理

  - 超时重传：RFC建议将拥塞窗口降至1个MSS，而由慢启动过渡至拥塞窗口的值应该调整至没别确认的数据量的1/2，但不能小于两个MSS
  - 快速恢复：不处理拥塞窗口的值

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423181405731.png" alt="image-20240423181405731" style="zoom: 67%;" />

### 3.7.2 TCP吞吐量

W：窗口长度的字节
RTT：当前往返时间
L：丢包率
MSS：最大报文段长度

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423181448325.png" alt="image-20240423181448325" style="zoom:67%;" />



经过高带宽TCP，且丢包率为L的情况下，吞吐量的描述

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423181751038.png" alt="image-20240423181751038" style="zoom:67%;" />

### 3.7.3 TCP公平性

多个TCP连接时，网络状况会趋向于**带宽均分**

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240423182231846.png" alt="image-20240423182231846" style="zoom:50%;" />

而一个链路中同时存在使用TCP的服务和UDP的服务情况下，那对于TCP是不友好的，UDP没有拥塞控制机制，可能会压制TCP流量

# 第四章 网络层：数据平面

网络层服务

- 在发送主机和接收主机对之间传送段（segment）
- 在发送段将段封装到数据报中
- 在接收端，将段上交给传输层实体
- 网络层协议存在于每一个主机和路由器
- 路由器检查每一个经过它IP数据报的头部

网路层的功能

- 转发：将分组从路由器的输入接口转发到合适的输出接口（类比通过单个路口）
- 路由：使用路由算法来决定分组从发送主机到目标接收主机的路径（类比起点->终点的路径规划）
  	--- 路径选择算法
  	--- 路由选择协议

网络层：数据平面、控制平面

**数据平面**
	--- 本地，每个路由器功能
	--- 决定从路由器输入端口到达的分组如何转发到输出端口
	--- 转发功能：传统，基于目标地址+转发表；SDN方式，基于多个字段+流表

**控制平面**
	--- 网络范围内的逻辑
	--- 决定数据报如何在路由器之间路由，决定数据报从源到目标主机之间的端到端路径
	--- 2个控制平面方法：传统路由算法，在路由器中被实现；sofware-defined networking(SDN)，在远程的服务器中实现

控制平面传统方法：在每一个路由器中的单独路由器算法元件，在控制平面进行交互
	控制平面：路由算法决定端到端路径
	数据平面：IP协议根据转发表 决定了IP数据报在此路由器上 的局部转发

控制平面SDN方法：远程控制器计算和分发转发表以供每条路由器使用，路由选择设备仅执行转发

**网络服务模型**

对于单个数据报的服务：可靠传送、 延迟保证（少于 40 ms的延迟）
对于数据报流的服务：保序数据报传送、保证流的最小带宽、分组之间的延迟差

## 4.1 路由器组成

![image-20240425230015674](C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240425230015674.png)

### 4.1.1 输入端口 (input port）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240427163550721.png" alt="image-20240427163550721" style="zoom: 80%;" />

- 左边方框：在物理层实现Bit级的接收
- 中间方框：在数据链路层完成链路层协议动作、解封装操作
- 右边方框分布式交换： 
  		-- 根据数据报头部的信息如：目的地址 ，在输入端口内存中的转发表中查找合适的输出端口（匹配+行动） 
    		-- 基于目标的转发：仅仅依赖于IP数据 报的目标IP地址（传统方法） 
    		-- 通用转发：基于头部字段的任意集合 进行转发

输入端口缓存
	-- 当交换机构的速率小于输入端口的汇聚速率时， 在输入 端口可能要排队（排队延迟以及由于输入缓存溢出会造成丢失!）
	-- Head-of-the-Line (HOL) blocking: 排在队头的数据报 阻止了队列中其他数据报向前移动

### 4.1.2 交换结构

通过交换结构，分组才能实际地从一个输入端口交换即转发到一个输出端口中

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240427165223758.png" alt="image-20240427165223758" style="zoom:80%;" />

将分组从输入缓冲区传输到合适的输出端口

交换速率：分组可以按照该速率从输入传输到输出
	-- 运行速度经常是输入/输出链路速率的若干倍
	-- N 个输入端口：交换机构的交换速度是输入线路速度的N倍比较理想

三种典型的交换结构

- **通过内存交换**

在CPU直接控制下的交换，采用传统的计算机
分组被拷贝到系统内存，CPU从分组的头部提取出目标 地址，查找转发表，找到对应的输出端口，拷贝到输出端口
转发速率被内存的带宽限制 (数据报通过BUS两遍) 一次只能转发一个分组

- **通过总线交换**

数据报通过共享总线，从输入端口转发到输出端口
总线竞争: 交换速度受限于总线带宽1次处理一个分组
1 Gbps bus, Cisco 1900； 32 Gbps bus, Cisco 5600；对于接入或企业级路由器，速度足够

- **通过互联网网络交换（如crossbar）**

同时并发转发多个分组，克服总线带宽限制
Banyan（榕树）网络，crossbar(纵横) 和其它的互联网络被开发，将多个处理 器连接成多处理器
当分组从端口A到达，转给端口Y；控 制器短接相应的两个总线
高级设计：将数据报分片为固定长度的信元，通过交换网络交换
Cisco 12000：以60 Gbps的交换速率通过互联网络

### 4.1.3 输出端口

- 当数据报从交换机构的到达速度比传输速率快 就需要输出端口缓存
- 由调度规则选择排队的数据报进行传输

输出端口排队：当多个输入端口同时向输出端口发送时，缓冲该分组（当通 过交换网络到达的速率超过输出速率则缓存）
	排队带来延迟，由于输出端口缓存溢出则丢弃数据报
	RFC 3439 拇指规则（经验性规则）：平均缓存大小 = 典型的RTT * 链路容量C

### 4.1.4 调度机制

调度: 选择下一个要通过链路传输的分组

FIFO (first in first out) scheduling: 按照分组到来的次序发送
	丢弃策略: 如果分组到达一个满的队列，哪个分组将会被抛弃
		-- tail drop: 丢弃刚到达的分组
		-- priority: 根据优先权丢失/移除分组
		-- random: 随机地丢弃/移除

调度策略：优先权调度发送最高优先权的分组

其他类别的优先权
	类别可能依赖于标记或者其他的头部字段, e.g. IP source/dest, port numbers, ds，etc.
	先传高优先级的队列中的分组，除非没有
	高（低）优先权中的分组传输次序：FIFO

## 4.2 网际协议：IP

### 4.2.1 IP数据包格式

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240427170249413.png" alt="image-20240427170249413" style="zoom:67%;" />

- 版本（号）：4 bits规定数据报的 IP 协议版本
- 首部长度：4 bits来确认lP 数据报中载荷（例如在这个数据报中被封装的运输层报文段）实际开始的地方
- 服务类型：包含在IPv4 首部中，使不同类型的 IP数据报（例如， 些特别要求低时延、高吞吐量或可靠性的数据报） 能相互区别
- 数据报长度：IP 数据报的总长度（首部加上数据），以字节计算；该字段常16 bits
- 标识、标志、片偏移：这三个字段与IP分片有关
- 寿命 (Time-To-Live, TTL)：确保数据报不会永远（如由于长时间的路由选择环路）在网络中循环
- 协议：指示 IP 数据报的数据部分应交给哪个特定的运输层协议
- 首部检验和：用于帮助路由器检测收到的IP数据报中的比特错误
- 源和目的 IP 地址：当某源生成一个数据报时，它在源IP字段中插入它的IP址，在目的 IP 地址字段中插入其最终目的地的地址 
- 选项：允许IP首部被扩展
- 数据：包含要交付给目的地的运输层报文段（TCP/UDP）

### 4.2.2 IP分片和重组

网络链路有MTU (最大传输单元)概念，表示链路层帧所携带的最大数据长度；不同的链路类型有不同的MTU

大的IP数据报在网络上被分片 (“fragmented”)：一个数据报被分割成若干个小的数据报
	相同的ID、不同的偏移量、最后一个分片标记为0

“重组”：在最终的目标主机进行，IP头部的信息被用于标识，排序相关分片

### 4.2.3 IP编址

IP 地址: 32位标示，对主机或者路由器的接口编址
接口: 主机/路由器和物理链路的连接处
	特征：路由器通常拥有多个接口、主机也有可能有多个接口、IP地址和每一个接口关联、一个IP地址和一个接口相关联

**子网，Subnets**

IP地址 = 子网部分(高位bits) + 主机部分(低位bits)

一个子网内的节点（主机或者路由器）它们的IP地址的**高位部分**相同 ，这些节点构成的网络的一部分叫做子网
无需路由器介入，子网内各主机可以在物理上相互直接到达

特殊IP地址
	子网部分: 全为 0---本网络
	主机部分: 全为0---本主机
	主机部分: 全为1--广播地址，这个网络的所有

IP地址分类
	Class A：126 networks ，16 million hosts
	Class B：16382networks ，64 K hosts
	Class C：2 million networks ，254 host
	Class D：multicast 	
	Class E：reserved for future

### 4.2.4 网络地址转换

网络地址转换（Network Address Translation, NAT）
	NAT 路由器对外界的行为就如同一个具有单一IP地址的单一设备 

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240427180130708.png" alt="image-20240427180130708" style="zoom:50%;" />

**NAT转换表**（NAT translation table）：表项中包含了端口号及IP地址

## 4.3 SDN

SDN特点

- 通用“ flowbased” 基于流的匹配+行动(e.g., OpenFlow)
- 控制平面和数据平面的分离
- 控制平面功能在数据交换设备之外实现
- 可编程控制，应用：在控制器之上以网络应用形式实现各种网络功能

# 第五章 网络层：控制平面

网络层的两个功能

- 转发: 将分组从路由器的一 个输入端口移到合适的输出端口
- 路由: 确定分组从源到目标 的路径

## 5.1 路由选择算法

路由：按照某种指标(传输延迟，所经过的站点数目等)找到一条从源节点到目标节点的较好路径 ==->== **路径规划**

以网络为单位进行路由（路由信息通告+路由计算）
		前提条件是：一个网络所有节点地址前缀相同，且物理上聚集
		网络到网络的路由 = 路由器 - 路由器之间路由

路由选择算法(routing algorithm)：网络层软件的一部分，完成路由功能

**汇集树**(sink tree) ：此节点到所有其它节点的最优路径形成的树；路由选择算法就是为所有路由器找到并使用汇集树

**路由选择算法的原则**

- 正确性(correctness)：算法必须是正确的和完整的，使分组正确发向目标站；完整：目标所有的站地址，在路由表中都能找到相应的表项；
- 简单性(simplicity)：算法在计算机上应简单：不应为了获取路由信息增加很多的通信量； 
- 健壮性(robustness)：算法应能适应通信量和网络拓扑的变化：不向很拥挤的链路发数据，不向断了的链路发送数据；
- 稳定性(stability)：产生的路由不应该摇摆 
- 公平性(fairness)：对每一个站点都公平 
- 最优性(optimality)：某一个指标的最优，时间、费用等指标，或综合指标；

**路由选择算法分类**

- 全局：所有的路由器拥有完整的拓扑和边的代价的信息（ “link state” 算法）
- 分布式：路由器只知道与它有物理连接关系的邻居路由器，和到相应邻居路由器的代价值，叠代地与邻居交换路由信息 计算路由信息

### 5.1.1 链路状态路由选择(link state routing)

配置LS路由选择算法的路由工作过程

- 各点通过各种渠道获得整个网络拓扑, 网络中所有链路代价等信息
- 使用LS路由算法，计算本站点到其它站点的最优路径(汇集树)，得到路由表

LS路由的基本工作过程

1. 发现相邻节点，获知对方网络地址
2. 测量到相邻节点的代价(延迟,开销) 
3. 组装一个LS分组，描述它到相邻节点的代价情况 
4. 将分组通过扩散的方法发到所有其它路由器，以上4步让每个路由器获得拓扑和边代价 
5. 通过Dijkstra算法找出最短路径（路由算法）

LS路由选择算法的工作原理

节点标记: 每一个节点使用(D(v),p(v)) 标记
	-- D(v)：从源节点由已知最优路径到达本节点的距离
	-- P(v)：前序节点来标注

2类节点
	-- 临时节点(tentative node) ：还没有找到从源 节点到此节点的最优路径的节点
	-- 永久节点(permanent node) ：已经找到了从 源节点到此节点的最优路径的节点

### 5.1.2 距离矢量路由选择(distance vector routing)

距离矢量路由选择的基本思想：各路由器维护一张路由表，各路由器与相邻路由器交换路由表；根据获得的路由信息，更新路由表

## 5.2 因特网中自治系统内部的路由选择

开放最短路优先，Open Shortest Path First，OSPF，一种链路状态协议，它使用洪泛链路状态信息和 Dijkstra 最低开销路径算法
	优点：安全、多条相同开销的路径、对单播与多播路由选择的综合支持、支持在单个AS中的层次结构

## 5.3 ISP之间的路由选择: BGP

边界网关协议，Broder Gateway Protocol，BGP

BGP 提供给每个AS以以下方法

- eBGP: 从相邻的ASes那里获得子网可达信息
-  iBGP: 将获得的子网可达信息传遍到AS内部的所有 路由器 
- 根据子网可达信息和策略来决定到达子网的“好”路径

每条直接连接以及所有通过该连接发送的 BGP 报文，称为 BGP 连接（BGP connection)
跨越两个 AS的BGP 连接称为外部 BGP (eBGP) 连接，而在相同 AS 中的两台路由器之间的 BGP 会话称为内部 BGP (iBGP）连接 

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428140236140.png" alt="image-20240428140236140" style="zoom:67%;" />

在真实的网络中，从某个给定的路由器到某个给定的目的地可能有多条不同的路径，每条通过了不同的AS序列

### 5.3.1 BGP报文

- OPEN: 打开TCP连接，认证发送方
- UPDATE: 通告新路径 (或者撤销原路径) 
- KEEPALIVE：在没有更新时保持连接，也用于对 OPEN 请求确认
- NOTIFICATION: 报告以前消息的错误，也用来关闭 连接

**BGP路径选择**

- 路由器可能获得一个网络前缀的多个路径，路由器必须进行路径的选择，路由选择可以基于： 
  	-- 本地偏好值属性: 偏好策略决定 
  	-- 最短AS-PATH ：AS的跳数 
  	-- 最近的NEXT-HOP路由器:热土豆路由
  	-- 附加的判据：使用BGP标示
- 一个前缀对应着多种路径，采用消除规则直到留下一条路径

## 5.4 SDN控制平面

Sofware defined networking

SDN体系结构的四个关键特征：

- 基于流的转发：SDN控制的交换机的分组转发工作 ，能够基于运输层网络层或链层首部中任意数的首部字段值进行 
- 数据平面与控制平面分离
- 网络控制功能：位于数据平面交换机外部
- 可编程的网络

### 5.4.1 SDN控制器和网络控制应用程序

SDN 控制器(网络OS)
	-- 维护网络状态信息
	-- 通过上面的北向API和网络 控制应用交互
	-- 通过下面的南向API和网络 交换机交互
	-- 逻辑上集中，但是在实现上 通常由于性能、可扩展性、 容错性以及鲁棒性采用分布式方法实现

网络控制应用
	-- 控制的大脑： 采用下层提供的服务（SDN控制器提供的API)实现网络功能（路由器交换机、接入控制、防火墙、负载均衡等功能）
	-- 非绑定：可以被第三方提供 ，与控制器厂商以通常上不同，与分组交换机厂商也可以不同

### 5.4.2 OpenFlow协议

概述：控制器和SDN交换机交互的协议，采用TCP 来交换报文
		   3种OpenFlow报文类型：控制器>交换机；异步（交换机>控制器 ）；对称 (misc)

OpenFlow: 控制器-交换机报文

- 特性：控制器查询交换机特性，交换机应答
-  配置：交换机查询/设置交换 机的配置参数
- 修改状态：增加删除修改 OpenFlow表中的流表
- packet-out：控制器可以将分 组通过特定的端口发出

OpenFlow: 交换机到控制器的报文

- 分组进入: 将分组（和它的控制） 传给控制器，见来自控制器的 packet-out报文
- 流移除: 在交换机上删除流表项 
- 端口状态: 通告控制器端口的变化

## 5.5 ICMP

Internet Control Message Protocol，因特网控制报文协议（ICMP )，被主机和路由器用来彼此沟通网络的信息ICMP最典型的用途是差错报告

ICMP 报文：类型、编码、加上IP数据报的头8B（第一个导致该ICMP报文的IP数据报）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428162355567.png" alt="image-20240428162355567" style="zoom:50%;" />

## 5.6 网络管理和SNMP

**网络管理**包括了硬件、软件和人类元素的设置，综合和协调，以便监测，测试，轮询，配置，分析，评价和控制网络和网元资源，用合理的成本满足实时性，运行能和服务质量的要求；

网络管理的5大功能：性能管理：、故障管理、配置管理、 账户管理、安全管理

架构：

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428162717146.png" alt="image-20240428162717146" style="zoom: 67%;" />

- 管理服务器 (managing server)：一个应用程序，通常有人的参与，并运行在网络运营中心 (NOC) 的集中式网络管理工作站上
- 被管设备 (managed device) ：网络装备的一部分（包括它的软件），位于被管理的网络中
- 在管理信息库 (Management Information Base, MIB)：一个被管设备中的每个被管对象的关联信息收集位置

**SNMP**

简单网络管理协议（Simple Network Management Protocol ），应用层协议，用于在管理服务器和代表管理服务器执行的代理之间传递网络管理控制和信息报文

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428163136818.png" alt="image-20240428163136818" style="zoom:67%;" />

# 第六章 链路层和局域网

nodes：主机和路由器是节点（网桥和 交换机也是）

links：沿着通信路径连接相邻节点通信信道的是链路
		有线链路、无线链路、局域网，共享性链路

数据链路层：负责从一个节点通过链路将 （帧中的）数据报发送到相邻的物理节点

**链路层服务**

- 成帧，链路接入
  		将数据报封装在帧中，加上帧头、帧尾部
  		如果采用的是共享性介质，信道接入获得信道访问权 
  		在帧头部使用“MAC”（物理）地址来标示源和目的 • 不同于IP地址
- 在（一个网络内）相邻两个节点完成可靠数据传递
- 在相邻节点间（一个子网内）进行可靠的转发
- 流量控制：使得相邻的发送和接收方节点的速度匹配
- 错误检测：差错由信号衰减和噪声引起；接收方检测出的错误，则通知发送端进行重传或丢弃帧
- 差错纠正：接收端检查和纠正bit错误，不通过重传来纠正错误
- 半双工和全双工

**链路层的实现**

主体部分在**网络适配器**（network adapter）中实现，也称网络接口卡（Network Interface Card，NIC）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428215557056.png" alt="image-20240428215557056" style="zoom:67%;" />

适配器通信

发送方：在帧中封装数据报、加上差错控制编码，实现RDT和流量控制功能等

接收方：检查有无出错，执行 rdt和流量控制功能等、解封装数据报，将至交给上层

## 6.1 差错检测和纠正

检测和纠正比特 ，Error Detection and- Correction，EDC

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428215949666.png" alt="image-20240428215949666" style="zoom: 67%;" />

### 6.1.1 奇偶校验

单bit奇偶校验：检测单个bit级错误
		发送方添加bit，接收方检测bit的数目的奇偶值是否与发送时设定的一样

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428220132031.png" alt="image-20240428220132031" style="zoom:67%;" />

2维奇偶校验： 检测和**纠正**单个bit错误（二维定位思想）

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428220400791.png" alt="image-20240428220400791" style="zoom:67%;" />

### 6.1.2 检验和方法

Internet校验和，目标: 检测在传输报文段时的错误（如位翻转），（注： 仅仅用在传输层）

发送方：将报文段看成16-bit整数，报文段的校验和为1的补码和，发送方将checksum的值放在UDP校验和字段

接收方：计算接收到的报文段的校验和，检查是否与携带校验和字段值一致
		不一致：检出错误
		一致：没有检出错误，但可能还是有错误

### 6.1.3 循环冗余检测

循环冗余检测 (Cyclic Redundancy Check，CRC) 编码

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240428221107725.png" alt="image-20240428221107725" style="zoom:67%;" />

发送方和接收方协商 r + 1 比特模式，称为生成多项式 (generator) , 们将其表示为G

对于一个给定的数据段 D, 发送方要选择 r 个附加比特 R，并将它们附加到D上，使得得到的 d + r 比特模式（被解释为一个比特进制数）用模2算术恰好能被G整除（即没有余数）

接收方用**G**去除接收到的 d + r 如果余数为非零，接收方知道出现差错，否则认为数据正确而被接收

## 6.2 多路访问链路和协议

两种类型的链路（一个子网内部链路连接形式）

点对点链路：point to point link 由链路一端的单个发送方和链路另一端的单个接收方组成
		拨号访问的PPP（点对点协议，Point to Point Protocol，PPP）、以太网交换机和主机之间的点对点链路

广播链路(共享线路或媒体)：能够让多个发送和接收节点都连接到相同的、单一的、共享的广播信道上
	传统以太网、HFC上行链路、802.11无线局域网

理想的多路访问协议
	-- 当一个节点要发送时，可以R速率发送
	-- 当M个节点要发送，每个可以以R/M的平均速率发送
	-- 完全分布的：没有特殊节点协调发送、没有时钟和时隙的同步
	-- 简单

### 6.2.1 信道划分协议

TDMA： time division multiple access，

- 轮流使用信道，信道的时间分为周期
- 每个站点使用每周期中固定的时隙(长度=帧传输时间) 传输帧
- 如果站点无帧传输，时隙空闲，浪费

FDMA： frequency division multiple access

- 信道的有效频率范围被分成一个个小的频段
- 每个站点被分配一个固定的频段
- 分配给站点的频段如果没有被使用，则空闲

CDMA： code division multiple access

- 所有站点在整个频段上同时进行传输, 采用编码原理加 以区分
- 完全无冲突
- 假定:信号同步很好,线性叠加

**区别**

- TDMA：不同的人在不同的时刻讲话
- FDMA：不同的组在不同的小房间里通信
- CDMA：不同的人使用不同的语言讲话

### 6.2.2 随机接入协议

- 当节点有帧要发送时：以信道带宽的全部 R bps发送且没有节点间的预先协调
- 两个或更多节点同时传输，会发生➜冲突 “collision”
- 随机存取协议规定：如何检测冲突、如何从冲突中恢复（如：通过稍后的重传）

三种随机MAC协议：时隙ALOHA 、ALOHA 、CSMA

时隙ALOHA：
	优点：节点可以以信道带宽全速连续传输、高度分布：仅需要节点之间在时隙上的同步、简单
	缺点：存在冲突，浪费时隙、帧发送时，仍有可能存在空闲时隙、节点检测冲突的时间<帧传输的时间、必须传完、需要时钟上同步

ALOHA(非时隙)
	简单、无须节点间在时间上同步
	当有帧需要传输：马上传输
	冲突的概率增加：帧在t0 发送，和其它在[t0 -1, t0 +1]区间内开始发送的帧冲突

CSMA

载波侦听多路访问，Carrier Sense Multiple Access，CSMA
具有碰撞检测的CSMA，CSMA with Collision Detection，CSMA/CD

- 说话之前先听，如果其他人正在说话等到他们说完话为止，在网络领域中， 被称为**载波侦听** (carrier sensing) 
  即一个节点在传输前先听信道，当来自另一个节点的帧正向信道上发送，节点则等待直到检测到一小段时间没有传输， 然后开始传输
- 如果与他人同时开始说话， 停止说话，在网络领域中，这被称为碰撞检测 (collision detection ) ，一个传输节点在传输时一直在侦听此信道。如果它检测到另一个节点正在传输干扰帧， 它就停止传输

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240429143133570.png" alt="image-20240429143133570" style="zoom:80%;" />

## 6.3 交换局域网

链路层地址有各种不同的称呼： LAN 地址 (LAN address) 、物理地址 physical address) 或MAC 地址 (MAC address) 
一般将链路层地址称为 MAC 地址（与局域网相连的每个接口都有一个唯一的MAC地址）

LAN（MAC/物理/以太网）地址
	-- 用于使帧从一个网卡传递到与其物理连接的另一个网卡 (在同一个物理网络中) 
	-- 48 bits MAC地址固化在适配器的ROM，有时也可以通过软件设定
	-- 理论上全球任何2个网卡的MAC地址都不相同

ARP，Address Resolution Protocol，地址解析协议
	用于进行网络层地址（IP地址）和链路层地址（MAC地址）之间的转换

ARP表：包括一些 LAN节点IP/MAC地址的映射
	将IP地址解析为MAC地址的过程和DNS类似（DNS将主机名解析为IP地址）

### 6.3.1 以太网

以太网物理拓扑：

- 总线：所有节点在一个碰撞域内，一次只允许一个节点发送
  	可靠性差，如果介质破损，截面形成信号的反射，会造成发送节点误认为是冲突
- 星型： 连接选择hub 或者 switch、一般是交换机在中心
  	每个节点以及相连的交换机端口使用（独立的）以太网协议（不会和其他节点的发送产生碰撞）

以太网帧结构：

![image-20240429144700445](C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240429144700445.png)

- 前同步码：用来同步接收方和发送方的时钟速率
  	使得接收方将自己的时钟调到发送端的时钟，从而可以按照发送端的时钟来接收所发送的帧
- 地址：6字节源MAC地址，目标MAC地址
  	帧目标地址=本站MAC地址，或是广播地址， 接收，递交帧中的数据到网络层，否则，适配器忽略该帧
- 类型：允许以太网复用多种网络层协议(大多情况下是IP，但也支持其它网络层协议Novell IPX和AppleTalk)
- CRC：在接收方校验，如果没有通过校验，丢弃错误帧
- 数据字段：承载IP数据报

以太网特征

- 无连接：帧传输前，发送方和接收方之间没有握手
- 不可靠：接收方适配器不发送ACKs或NAKs给发送 方
  	递交给网络层的数据报流可能有gap
  	如上层使用像传输层TCP协议这样的rdt，gap会被补上(源主机，TCP实体)，否则应用层就会看到gap
- 以太网的MAC协议：采用二进制退避的CSMA/CD介质访问控制形式

以太网标准

- 相同的MAC协议（介质访问控制）和帧结构
- 不同的速率：2 Mbps、10 Mbps 、100 Mbps 、 1Gbps 、 10G bps
- 不同的物理层标准  不同的物理层媒介：光纤，同轴电缆和双绞线

### 6.3.2 链路层交换机

基本特性：

- 链路层设备：扮演主动角色（端口执行以太网协议）
  		-- 对帧进行存储和转发  对于到来的帧，检查帧头，根据目标MAC地址进行选择性转发
  		-- 当帧需要向某个（些）网段进行转发，需要使用 CSMA/CD进行接入控制
  		-- 通常一个交换机端口一个独立网段
- 透明：主机对交换机的存在可以不关心
  		-- 通过交换机相联的各节点好像这些站点是直接相联的一样
  		-- 有MAC地址；无IP地址
- 即插即用，自学习，交换机无需配置

交换机转发表

每个交换机都有一个交换表，switch table，每个 表项包括：主机的MAC地址，到达该MAC经过的接口，时戳

当交换机收到一个帧：记录进入链路，发送主机的MAC地址，然后使用目标MAC地址对交换表进行索引

**交换机和路由器的区别**

- 都是存储转发设备，但层次不同
  	-- 交换机：链路层设备（检查 链路层头部）
  	-- 路由器：网络层设备（检查 网络层的头部）
- 都有转发表
  	交换机：
  		-- 维护交换表，按照 MAC地址转发 • 执行过滤、自学习和生成树算法
  		-- 即插即用；二层设备，速率高
  		-- 执行生成树算法，限制广播帧的 转发
  		-- ARP表项随着站点数量增多而增 多
  	路由器维护路由表，执行路由算法
  		-- 路由算法能够避免环路，无需执行生成树算法，可以以各种拓扑构建网络
  		-- 对广播分组做限制
  		-- 不是即插即用的，配置网络地址（子网前缀）

### 6.3.3 虚拟局域网

虚拟局域网 (Virtual Local Area Network, VLAN
支持 VLAN 交换机允许经一个单一的物理局域网基础设施定义多个虚拟局域网

基于端口的VLAN: 交换机端口成组 ( 通过交换机管理软件)，以至于 单个的交换机可以分成若干虚拟 LANs

基于端口的VLAN

- 流量隔离: 从/到1-8端口 的流量只会涉及到1-8 （也可以基于MAC地址进行VLAN定义）
- 动态成员: 成员可以在 VLANs之间动态分配
- 在VLANs间转发:通过路由器进行转发 ：实际操作中，设备生产商可以提供： 交换机和路由器的单一设备

如果有多个交换机，希望它们相连并且共享VLANs信息
	方法1：各交换机每个VLAN一个端口和另外交换机相应 VLAN端口相连->扩展性问题
	trunk port干线端口: 多个交换机共享定义的VLAN，在它们之间传输帧

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240429163929589.png" alt="image-20240429163929589" style="zoom:80%;" />

## 6.4 链路虚拟化

多协议标签交换 Multiprotoco Label Switching，MPLS，一种分组交换的虚电路网络，改善IP路由器的转发速度
	关键概念：**固定长度标签**

MPLS使能的路由器之间传输的一个链路层帧
要给MPLS使能的路由器一般称为标签交换路由器，Label-switched router

<img src="C:/Users/Small Black/AppData/Roaming/Typora/typora-user-images/image-20240429164403546.png" alt="image-20240429164403546" style="zoom:67%;" />

- MPLS网络按照标签label进行分组的转发：类似于VC、有基于标签的转发表、基于虚电路表、IP vs 线路交换
- 标签交换的过程：
  	入口路由器：LER对进入的分组按照EFC的定义打上标签
  	在MPLS网络中（虚拟成了链路）对分组按照标签进行交换
  	到了出口路由器，再将标签摘除
  	支持MPLS的路由器组构成的网络，从IP网络的角度来看虚拟成了链路
- 标签封装：一些列标准定义了在ATM,FR和以太网中如何封装，利用原有网络中的机制VCI，或者定义新的标签
- 建立基于标签的转发表-信令协议：支持逐跳和 显式路由：路由信息传播，路由计算(基于Qos， 基于策略的)，标签分发

IP路由:到达目标的路径仅仅取决于 目标地址 MPLS and IP router
MPLS路由：到达目标的路由，可以 基于源和目标地址

## 6.5 数据中心网络

data center network，这些数据中心网络将其内部主机彼此互联并与因特网中的数据中心互联

数据中心网络支持两种类型的流量：在外部客户与内部主机之间流动的流量，以及内部主机之间流动的流量

负载均衡器: 应用层路由

- 接受外部的客户端请求
- 将请求导入到数据中心内部
- 返回结果给外部客户端 (对于客户端隐藏 数据中心的内部结构)

在交换机之间，机器阵列之间有丰富的互连措施

- 在阵列之间增加吞吐 (多个可能的路由路径) 
- 通过冗余度增加可靠性

# 随笔

|                 全称                 | 缩写 |            中文            |
| :----------------------------------: | :--: | :------------------------: |
|      Internet Service Provider       | ISP  |      因特网服务提供商      |
|    Transmission Control Protocol     | TCP  |        传输控制协议        |
|          Internet Protocol           |  IP  |          网络协议          |
|          Internet Standard           |  /   |         因特网标准         |
|   Internet Engineering Task Force    | IETF |      因特网工程任务组      |
|         Request For Comment          | RFC  | 请求评论（IETF的标准文档） |
|       Digital Subscriber Line        | DSL  |         数字用户线         |
|       Optical Line Terminator        | OLT  |       光纤线路端接器       |
|          Local Area Network          | LAN  |           区域网           |
|     HyperText Transfer Protocol      | HTTP |       超文本传输协议       |
|           Round-Trip Time            | RTT  |          往返时间          |
|    Simple Mail Transfer Protocol     | SMTP |      简单邮件传输协议      |
|           Top-Level Domain           | TLD  |           顶级域           |
| Dynamic Adaptive Streaming over HTTP | DASH |     HTTP的动态适应性流     |
|     Content Distribution Network     | CDN  |         内容分发网         |
|          Autonomous System           |  AS  |          自治系统          |
|     Address Resolution Protocol      | ARP  |        地址解析协议        |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |
|                                      |      |                            |

RFC的文档定义了TCP、IP、HTTP和SMTP（用于电子邮件）等协议

[从点击网页到显示](8.28 复制打开抖音，看看【织点代码的作品】从点击网页到显示需要多少-DNS、HTTP、CA、... https://v.douyin.com/iYWGj9ud/ teo:/ 10/11 v@F.hO )
